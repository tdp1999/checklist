"use strict";(self.webpackChunkchecklist=self.webpackChunkchecklist||[]).push([[392],{4392:(k,h,a)=>{a.r(h),a.d(h,{CategoryModule:()=>K});var d=a(6362),y=a(6352),A=a(4505),D=a(4139),x=a(1942),p=a(9095),f=a(6942),g=a(2565),r=a(587),c=a(5758),S=a(9151),E=a(5722),Z=a(3298),I=a(823),M=a(2692),C=a(8494),v=a(2798),t=a(3184),m=a(4770),b=a(4683),U=a(7987),u=a(7317);let T=(()=>{class o{constructor(e,n,s,l,V){this._fb=e,this._cdr=n,this._slugifyPipe=s,this._dialogRef=l,this.data=V,this.title="",this.submitText="OK",this._subs=new v.Y}ngOnInit(){var e;switch(this._dialogRef.updateSize("60%","fit-content"),this.data.action){case g.U.CREATE:this.title="Create New Category",this.submitText="Add",this.form=this._fb.group({name:["",[r.kI.required]],slug:["",[r.kI.required],null===(e=this.data.validateList)||void 0===e?void 0:e.slug.bind(this.data.thisRef)],completePercentage:[0],description:[""]});break;case g.U.EDIT:this.title="Edit Category",this.submitText="Save",this.form=this._fb.group({_id:[this.data.payload._id],name:[this.data.payload.name],slug:[this.data.payload.slug],description:[this.data.payload.description]})}this.autocompleteSlug()}ngOnDestroy(){this._subs.unsubscribe()}get f(){return this.form.controls}submitForm(){var e;console.log(this.data.action),console.log(this.form.value),null===(e=this.data.callback)||void 0===e||e.bind(this.data.thisRef)(this.form.value),this._cdr.markForCheck()}autocompleteSlug(){this._subs.add(this.f.name.valueChanges.pipe((0,S.h)(e=>e.length>0),(0,E.O)(this.f.name.value),(0,Z.x)(),(0,I.b)(500),(0,M.b)(e=>{this.f.slug.setValue(this._slugifyPipe.transform(e))})).subscribe())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(t.sBO),t.Y36(C.N),t.Y36(c.so),t.Y36(c.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-custom-dialog"]],features:[t._Bn([C.N])],decls:24,vars:4,consts:[[3,"formGroup","ngSubmit"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],["appearance","fill"],["formControlName","name","matInput","","placeholder","Add name"],["matErrorMessage",""],["formControlName","slug","matInput","","placeholder","Add slug"],["formControlName","description","matInput","","placeholder","Add description","matErrorMessage",""],["mat-dialog-actions",""],["type","submit","mat-button","","mat-dialog-close","",3,"disabled"],["type","button","mat-button","","mat-dialog-close",""]],template:function(e,n){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.submitForm()}),t.TgZ(1,"h1",1),t._uU(2),t.qZA(),t.TgZ(3,"div",2)(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",4)(8,"mat-error",5),t.qZA(),t.TgZ(9,"mat-form-field",3)(10,"mat-label"),t._uU(11,"Slug"),t.qZA(),t._UZ(12,"input",6)(13,"mat-error",5),t.qZA(),t.TgZ(14,"mat-form-field",3)(15,"mat-label"),t._uU(16,"Description"),t.qZA(),t._UZ(17,"textarea",7)(18,"mat-error"),t.qZA()(),t.TgZ(19,"div",8)(20,"button",9),t._uU(21),t.qZA(),t.TgZ(22,"button",10),t._uU(23,"Cancel"),t.qZA()()()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(2),t.Oqu(n.title),t.xp6(18),t.Q6J("disabled",!n.form.valid),t.xp6(1),t.hij(" ",n.submitText," "))},directives:[r._Y,r.JL,r.sg,c.uh,c.xY,m.KE,m.hX,r.Fj,b.Nt,r.JJ,r.u,m.TO,U.H,c.H8,u.lW,c.ZT],styles:[".dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0}),o})();var N=a(549),O=a(7514),R=a(2528),Y=a(2422),J=a(2466);const P=function(o,i){return[o,i]};function j(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return s.onActionTriggered({type:s.actionType.CREATE,payload:null})}),t._uU(2," Add Category "),t.qZA(),t.TgZ(3,"app-datatable",4),t.NdJ("onActionTriggered",function(s){return t.CHM(e),t.oxw().onActionTriggered(s)})("onPaginationChange",function(s){return t.CHM(e),t.oxw().onPaginationChange(s)}),t.qZA()()}if(2&o){const e=i.ngIf,n=t.oxw();t.xp6(3),t.Q6J("columns",n.columns)("totalItems",n.totalItems)("dataSource",e)("displayedColumns",n.displayedColumn)("actions",t.WLB(5,P,n.actionType.EDIT,n.actionType.DELETE))}}function B(o,i){1&o&&t._UZ(0,"app-loading-spinner")}function $(o,i){1&o&&t.YNc(0,B,1,0,"ng-template",null,5,t.W1O)}const F=[{path:"",component:(()=>{class o{constructor(e,n,s){this._categoryService=e,this._dialog=n,this._snackbar=s,this._sub=new v.Y,this.actionType=g.U,this.displayedColumn=["#","name","slug","completePercentage"],this.columns=[{columnDef:"#",header:"No.",cell:l=>"0"},{columnDef:"name",header:"Name",cell:l=>`${l.name}`},{columnDef:"slug",header:"Slug",cell:l=>`${l.slug}`},{columnDef:"completePercentage",header:"Complete Percentage",cell:l=>`${l.completePercentage}`}],this.categorySubject$=new A.X(!0),this.filter={_page:1},this.totalItems=0}ngOnInit(){this.categories$=this.categorySubject$.asObservable().pipe((0,p.w)(()=>this._categoryService.getCategoryList(this.filter).pipe((0,f.U)(e=>(this.totalItems=e.paginations._totalRow,e.data)))))}ngOnDestroy(){this._sub.unsubscribe()}onActionTriggered(e){let{type:n,payload:s}=e;switch(n){case g.U.CREATE:this.addCategory();break;case g.U.EDIT:this.editCategory(s);break;case g.U.DELETE:this.deleteCategory(s)}}onPaginationChange(e){this.filter._page=e.pageIndex+1,this.filter._limit=e.pageSize,this.categorySubject$.next(!0)}addCategory(){this._dialog.open(T,{data:{action:this.actionType.CREATE,callback:this.onAddCategory,validateList:{slug:this.validateSlug},thisRef:this}})}onAddCategory(e){this._sub.sink=this._categoryService.addCategory(e).subscribe(n=>{this.categorySubject$.next(!0),this._snackbar.open("Category added","Dismiss",{duration:2e3})})}editCategory(e){this._sub.sink=this._categoryService.retrieveCategoryByID(e).subscribe(n=>{this._dialog.open(T,{data:{action:this.actionType.EDIT,payload:n,callback:this.onEditCategory,thisRef:this}})})}onEditCategory(e){this._sub.sink=this._categoryService.updateCategory(e).subscribe(n=>{this.categorySubject$.next(!0),this._snackbar.open("Category updated","Dismiss",{duration:2e3})})}deleteCategory(e){console.log(e);let n=this._dialog.open(N.$,{data:{title:"Delete Category",message:"Are you sure you want to delete this category?",submitText:"Delete"}});this._sub.sink=n.afterClosed().pipe((0,p.w)(s=>"Confirmed"===s?this._categoryService.deleteCategoryByID(e._id):(0,D.of)(null))).subscribe(s=>{this.categorySubject$.next(!0),this._snackbar.open("Category deleted","Dismiss",{duration:2e3})})}validateSlug(e){return(0,x.H)(300).pipe((0,p.w)(()=>this._categoryService.retrieveCategoryBySlug(e.value).pipe((0,f.U)(n=>n[0]?{slugExists:!0}:null))))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(O.o),t.Y36(c.uw),t.Y36(R.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-category"]],decls:4,vars:3,consts:[["class","container",4,"ngIf"],["loadingOrError",""],[1,"container"],["title","Add category","type","button","mat-raised-button","","color","primary",3,"click"],[3,"columns","totalItems","dataSource","displayedColumns","actions","onActionTriggered","onPaginationChange"],["loading",""]],template:function(e,n){1&e&&(t.YNc(0,j,4,8,"div",0),t.ALo(1,"async"),t.YNc(2,$,2,0,"ng-template",null,1,t.W1O)),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.categories$))},directives:[d.O5,u.lW,Y.n,J.g],pipes:[d.Ov],styles:[".container[_ngcontent-%COMP%]{max-width:1600px;margin:20px auto;padding:0 15px}"],changeDetection:0}),o})()}];let z=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[y.Bz.forChild(F)],y.Bz]}),o})();var L=a(961),W=a(3776),H=a(8388),X=a(9021);let Q=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[d.ez,r.UX,r.u5,c.Is,m.lN,b.c,u.ot,H.s,X.s]]}),o})(),G=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[d.ez,u.ot,c.Is]]}),o})(),K=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[d.ez,z,L.x,u.ot,Q,G,W.z]]}),o})()}}]);
//# sourceMappingURL=392.f3f80aa9ae0fee5f.js.map